@using Microsoft.Web;
@using Microsoft.Web.Helpers;
@using System.Xml;
@using System.Web.Http;
@using System.Xml.Linq;
@using System.Xml;

@*This file downloads the Federal XML File from the SBA Website and stores it to the Server under the /App_Data/UploadedFiles folder.*@

@{
    ViewBag.Title = "DownloadFile";
}

@{

    if (IsPost)
    {

        var strFilePath = "http://api.sba.gov/loans_grants/federal.xml";

        XmlDocument xmldoc = new XmlDocument();
        xmldoc.Load(strFilePath);

        XmlNodeList xNodelst = xmldoc.DocumentElement.SelectNodes("grant_loan");
        foreach (XmlNode xNode in xNodelst)
        {

        }

        xmldoc.Save(Server.MapPath("~/App_Data/UploadedFiles/" + "federal.xml"));

    }

}

<!DOCTYPE html>
<html>
<head>
    <title>Download/Save XML Files</title>
</head>
<body>
    <br/>
    <br/>
    <br/>
    <h3>Click on the Button below to Download the SBA File from the website.</h3>
    <br/>
    <br/>
    <h1>Download XML Files</h1>
    <form action="" method="post">
        <input type="submit" value="Load Federal XMLDocument" />
    </form>
    @if (IsPost)
    {
        <span>XML File uploaded successfully!</span>
        <br />
    }
</body>
</html>

